<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ¨Ø¯ÛŒÙ„ ØªØµÙˆÛŒØ± Ø¨Ù‡ Ø§ÛŒÙ…ÙˆØ¬ÛŒ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
            background-color: black;
            color: white;
        }
        .emoji-image {
            font-size: 10px; /* Ø§ÙØ²Ø§ÛŒØ´ Ø³Ø§ÛŒØ² Ø§ÛŒÙ…ÙˆØ¬ÛŒâ€ŒÙ‡Ø§ Ø¨Ø±Ø§ÛŒ Ù†Ù…Ø§ÛŒØ´ Ø¬Ø²Ø¦ÛŒØ§Øª Ø¨ÛŒØ´ØªØ± */
            white-space: pre;
            line-height: 10px;
            background-color: black;
            display: inline-block;
            text-align: left;
        }
    </style>
</head>
<body>
    <h1>ØªØ¨Ø¯ÛŒÙ„ ØªØµÙˆÛŒØ± Ø¨Ù‡ Ø§ÛŒÙ…ÙˆØ¬ÛŒ</h1>
    <input type="file" id="imageInput" accept="image/*">
    <button onclick="convertToEmoji()">ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ø§ÛŒÙ…ÙˆØ¬ÛŒ</button>
    <button id="downloadBtn" style="display: none;" onclick="downloadEmojiImage()">Ø¯Ø§Ù†Ù„ÙˆØ¯</button>
    <pre id="emojiOutput" class="emoji-image"></pre>

    <script>
        function convertToEmoji() {
            const input = document.getElementById('imageInput');
            if (!input.files.length) {
                alert('Ù„Ø·ÙØ§Ù‹ ÛŒÚ© ØªØµÙˆÛŒØ± Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.');
                return;
            }

            const file = input.files[0];
            const reader = new FileReader();

            reader.onload = function (event) {
                const img = new Image();
                img.src = event.target.result;

                img.onload = function () {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');

                    // Ø§ÙØ²Ø§ÛŒØ´ Ø¬Ø²Ø¦ÛŒØ§Øª ØªØµÙˆÛŒØ± (Û±Û° Ø¨Ø±Ø§Ø¨Ø± Ø¨ÛŒØ´ØªØ±)
                    const maxSize = 100; // Ø­Ø¯Ø§Ú©Ø«Ø± Ø¹Ø±Ø¶ ÛŒØ§ Ø§Ø±ØªÙØ§Ø¹ Ú©Ø§Ù†ÙˆØ§Ø³
                    const scale = Math.max(img.width, img.height) / maxSize;
                    canvas.width = Math.floor(img.width / scale);
                    canvas.height = Math.floor(img.height / scale);

                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    const data = imageData.data;

                    let emojiOutput = '';
                    for (let y = 0; y < canvas.height; y++) {
                        for (let x = 0; x < canvas.width; x++) {
                            const i = (y * canvas.width + x) * 4;
                            const r = data[i];
                            const g = data[i + 1];
                            const b = data[i + 2];

                            emojiOutput += getEmojiByColor(r, g, b);
                        }
                        emojiOutput += '\n';
                    }

                    document.getElementById('emojiOutput').textContent = emojiOutput;
                    document.getElementById('downloadBtn').style.display = 'inline-block';
                };
            };

            reader.readAsDataURL(file);
        }

        function getEmojiByColor(r, g, b) {
            const brightness = (r * 0.299 + g * 0.587 + b * 0.114) / 255;
            let hue = Math.atan2(Math.sqrt(3) * (g - b), 2 * r - g - b) * (180 / Math.PI);
            if (hue < 0) hue += 360;

            // Ù„ÛŒØ³Øª Ø§ÛŒÙ…ÙˆØ¬ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ± Ø¨Ø±Ø§ÛŒ Ø¯Ù‚Øª Ø±Ù†Ú¯ÛŒ Ø¨Ø§Ù„Ø§ØªØ±
            const emojis = [
                'â¬›', 'â¬œ', 'ğŸ”´', 'ğŸŸ ', 'ğŸŸ¡', 'ğŸŸ¢', 'ğŸ”µ', 'ğŸŸ£', 'ğŸŸ¤', 'âš«', 'âšª', 'ğŸ”º', 'ğŸ”»', 'ğŸ”¶', 'ğŸ”·', 'ğŸ”³',
                'ğŸŸ¥', 'ğŸŸ§', 'ğŸŸ¨', 'ğŸŸ©', 'ğŸŸ¦', 'ğŸŸª', 'ğŸŸ«', 'ğŸ´', 'ğŸ³ï¸', 'ğŸ”˜', 'ğŸŸ°', 'ğŸ¨', 'ğŸ­', 'ğŸ²', 'ğŸµ', 'ğŸ¶', 'ğŸ¼',
                'ğŸ§', 'ğŸ¤', 'ğŸ·', 'ğŸº', 'ğŸ¸', 'ğŸ»', 'ğŸ®', 'ğŸ°', 'ğŸ¯', 'ğŸ³', 'âš½', 'ğŸ€', 'ğŸˆ', 'âš¾', 'ğŸ¥', 'ğŸ',
                'ğŸ‰', 'ğŸ±', 'ğŸ¾', 'ğŸ¥', 'ğŸ¿', 'ğŸ‚', 'â›·ï¸', 'ğŸ‹ï¸', 'ğŸŠ', 'ğŸš´', 'ğŸšµ', 'ğŸ¥‡', 'ğŸ¥ˆ', 'ğŸ¥‰', 'ğŸ†', 'ğŸ…',
                'ğŸ–ï¸', 'ğŸ¥Š', 'ğŸ¥‹', 'â›¸ï¸', 'ğŸ½', 'â›³', 'ğŸ¯', 'ğŸ¥Œ', 'ğŸ¹', 'ğŸ£', 'ğŸŒ', 'ğŸŒ', 'ğŸŒ', 'ğŸª', 'ğŸ’«', 'â­',
                'ğŸŒŸ', 'âœ¨', 'ğŸ”¥', 'ğŸ’§', 'ğŸŒŠ', 'ğŸŒ€', 'â˜ï¸', 'â›ˆï¸', 'ğŸŒ©ï¸', 'ğŸŒªï¸', 'ğŸŒˆ', 'â„ï¸', 'â˜ƒï¸', 'â›¸ï¸', 'â˜€ï¸', 'ğŸŒ¤ï¸',
                'ğŸŒ¥ï¸', 'ğŸŒ¦ï¸', 'ğŸŒ§ï¸', 'ğŸŒ¨ï¸', 'ğŸŒ«ï¸', 'ğŸŒ¬ï¸', 'ğŸŒµ', 'ğŸ‹', 'ğŸ€', 'ğŸ', 'ğŸŒ³', 'ğŸŒ´', 'ğŸŒ±', 'ğŸŒ¿', 'ğŸƒ', 'ğŸ‚',
                'â˜˜ï¸', 'ğŸŒº', 'ğŸŒ»', 'ğŸŒ¹', 'ğŸ¥€', 'ğŸŒ¾', 'ğŸŒ¼', 'ğŸŒ·', 'ğŸ’', 'ğŸ„', 'ğŸ„', 'ğŸ‹', 'ğŸŒµ', 'ğŸ', 'ğŸ', 'ğŸŒ',
                'ğŸ‰', 'ğŸ‡', 'ğŸ“', 'ğŸ¥­', 'ğŸ‘', 'ğŸ’', 'ğŸŠ', 'ğŸ', 'ğŸ¥¥', 'ğŸ¥', 'ğŸˆ', 'ğŸ', 'ğŸ¥•', 'ğŸŒ½', 'ğŸ¥’', 'ğŸ¥¬',
                'ğŸ¥¦', 'ğŸ§„', 'ğŸ§…', 'ğŸ¥”', 'ğŸ ', 'ğŸ¥œ', 'ğŸŒ°', 'ğŸ', 'ğŸ¥–', 'ğŸ¥¯', 'ğŸ¥', 'ğŸ¥“', 'ğŸ¥©', 'ğŸ—', 'ğŸ–', 'ğŸ”',
                'ğŸŸ', 'ğŸ•', 'ğŸŒ­', 'ğŸ¿', 'ğŸ¥¤', 'ğŸ©', 'ğŸª', 'ğŸ°', 'ğŸ‚', 'ğŸ§', 'ğŸ«', 'ğŸ¬', 'ğŸ­', 'ğŸ®', 'ğŸ¯',
                'ğŸ·', 'ğŸ¸', 'ğŸº', 'ğŸ»', 'ğŸ¥‚', 'ğŸ¥ƒ', 'ğŸ¾', 'ğŸ¶', 'ğŸ·', 'ğŸ¥§', 'ğŸ–', 'ğŸ¥¨', 'ğŸ²', 'ğŸ³', 'ğŸ¿', 'ğŸº',
                'ğŸ´', 'ğŸ¥„', 'ğŸ½ï¸', 'ğŸ—', 'ğŸ¥©', 'ğŸ–', 'ğŸ¤', 'ğŸ ', 'ğŸ', 'ğŸ‹', 'ğŸ’', 'ğŸ‰', 'ğŸŒ', 'ğŸ“', 'ğŸ¥­', 'ğŸ¥¥', 'ğŸ¥',
                // Ù„ÛŒØ³Øª Ø§ÛŒÙ…ÙˆØ¬ÛŒâ€ŒÙ‡Ø§ÛŒ Ø¨ÛŒØ´ØªØ±
            ];

            // ØªØ¨Ø¯ÛŒÙ„ hue Ùˆ brightness Ø¨Ù‡ Ù…Ù‚Ø¯Ø§Ø± Ø¹Ø¯Ø¯ÛŒ Û° ØªØ§ Û´Û°Û¹Û¶
            const hueIndex = Math.floor((hue / 360) * 64);
            const brightnessIndex = Math.floor(brightness * 64);  // Ø§ÙØ²Ø§ÛŒØ´ Ø¯Ù‚Øª Ø±Ù†Ú¯ÛŒ
            const index = (hueIndex * 64 + brightnessIndex) % emojis.length;

            return emojis[index];
        }

        function downloadEmojiImage() {
            const outputDiv = document.getElementById('emojiOutput');
            const blob = new Blob([outputDiv.textContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'emoji_image.txt';
            a.click();
        }
    </script>
</body>
</html>
