<!DOCTYPE html>
<html lang="fa">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ØªØ¨Ø¯ÛŒÙ„ ØªØµÙˆÛŒØ± Ø¨Ù‡ Ø§ÛŒÙ…ÙˆØ¬ÛŒ</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            margin: 20px;
        }
        canvas {
            display: block;
            margin: 20px auto;
            border: 1px solid #000;
        }
        .emoji-image {
            font-size: 10px; /* Ø§Ù†Ø¯Ø§Ø²Ù‡ Ø§ÛŒÙ…ÙˆØ¬ÛŒâ€ŒÙ‡Ø§ */
            white-space: pre;
        }
    </style>
</head>
<body>
    <h1>ØªØ¨Ø¯ÛŒÙ„ ØªØµÙˆÛŒØ± Ø¨Ù‡ Ø§ÛŒÙ…ÙˆØ¬ÛŒ</h1>
    <input type="file" id="imageInput" accept="image/*">
    <button onclick="convertToEmoji()">ØªØ¨Ø¯ÛŒÙ„ Ø¨Ù‡ Ø§ÛŒÙ…ÙˆØ¬ÛŒ</button>
    <button id="downloadBtn" style="display: none;" onclick="downloadEmojiImage()">Ø¯Ø§Ù†Ù„ÙˆØ¯</button>
    <div id="emojiOutput" class="emoji-image"></div>

    <script>
        function convertToEmoji() {
            const input = document.getElementById('imageInput');
            if (!input.files.length) {
                alert('Ù„Ø·ÙØ§Ù‹ ÛŒÚ© ØªØµÙˆÛŒØ± Ø§Ù†ØªØ®Ø§Ø¨ Ú©Ù†ÛŒØ¯.');
                return;
            }

            const file = input.files[0];
            const reader = new FileReader();

            reader.onload = function (event) {
                const img = new Image();
                img.src = event.target.result;

                img.onload = function () {
                    const canvas = document.createElement('canvas');
                    const ctx = canvas.getContext('2d');

                    // ØªÙ†Ø¸ÛŒÙ… Ø§Ù†Ø¯Ø§Ø²Ù‡ Ú©Ø§Ù†ÙˆØ§Ø³ Ø¨Ù‡ Ø§Ù†Ø¯Ø§Ø²Ù‡ ØªØµÙˆÛŒØ±
                    const scale = 10; // Ù…Ù‚ÛŒØ§Ø³ Ú©Ø§Ù‡Ø´ ØªØµÙˆÛŒØ±
                    canvas.width = img.width / scale;
                    canvas.height = img.height / scale;

                    // Ø±Ø³Ù… ØªØµÙˆÛŒØ± Ø±ÙˆÛŒ Ú©Ø§Ù†ÙˆØ§Ø³
                    ctx.drawImage(img, 0, 0, canvas.width, canvas.height);

                    // Ø®ÙˆØ§Ù†Ø¯Ù† Ù¾ÛŒÚ©Ø³Ù„â€ŒÙ‡Ø§ÛŒ ØªØµÙˆÛŒØ±
                    const imageData = ctx.getImageData(0, 0, canvas.width, canvas.height);
                    const data = imageData.data;

                    let emojiOutput = '';
                    for (let i = 0; i < data.length; i += 4) {
                        const r = data[i];
                        const g = data[i + 1];
                        const b = data[i + 2];

                        // ØªØ¹ÛŒÛŒÙ† Ø§ÛŒÙ…ÙˆØ¬ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø±Ù†Ú¯
                        const emoji = getEmojiByColor(r, g, b);
                        emojiOutput += emoji;
                    }

                    // Ù†Ù…Ø§ÛŒØ´ Ø®Ø±ÙˆØ¬ÛŒ Ø§ÛŒÙ…ÙˆØ¬ÛŒ
                    const outputDiv = document.getElementById('emojiOutput');
                    outputDiv.textContent = formatEmojiOutput(emojiOutput, canvas.width);

                    // Ù†Ù…Ø§ÛŒØ´ Ø¯Ú©Ù…Ù‡ Ø¯Ø§Ù†Ù„ÙˆØ¯
                    document.getElementById('downloadBtn').style.display = 'inline-block';
                };
            };

            reader.readAsDataURL(file);
        }

        function getEmojiByColor(r, g, b) {
            // ØªØ¹Ø±ÛŒÙ Ø§ÛŒÙ…ÙˆØ¬ÛŒ Ø¨Ø± Ø§Ø³Ø§Ø³ Ø±Ù†Ú¯
            if (r > 200 && g > 200 && b > 200) return 'â¬œ'; // Ø³ÙÛŒØ¯
            if (r > 150 && g < 100 && b < 100) return 'â¤ï¸'; // Ù‚Ø±Ù…Ø²
            if (g > 150 && r < 100 && b < 100) return 'ğŸ’š'; // Ø³Ø¨Ø²
            if (b > 150 && r < 100 && g < 100) return 'ğŸ’™'; // Ø¢Ø¨ÛŒ
            if (r > 100 && g > 100 && b < 100) return 'ğŸ’›'; // Ø²Ø±Ø¯
            return 'â¬›'; // Ø³ÛŒØ§Ù‡
        }

        function formatEmojiOutput(emojiOutput, width) {
            const lines = [];
            for (let i = 0; i < emojiOutput.length; i += width) {
                lines.push(emojiOutput.slice(i, i + width));
            }
            return lines.join('\n');
        }

        function downloadEmojiImage() {
            const outputDiv = document.getElementById('emojiOutput');
            const blob = new Blob([outputDiv.textContent], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'emoji_image.txt';
            a.click();
        }
    </script>
</body>
</html>
